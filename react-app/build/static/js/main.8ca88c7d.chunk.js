(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{11:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),s=n(12),i=n.n(s),o=(n(17),n(5)),c=n(6),u=n(8),l=n(7),p=(n(18),n(1)),h=n.n(p),d=n(3),j=(n(11),n(4)),g=n.n(j);window.document.url;var b={getLocationByZip:function(e,t,n){var a={url:"/api/external/location/"+e,dataType:"json",type:"GET"};return g.a.ajax(a)},getWeatherMetaData:function(e,t,n,a){var r={url:"/api/external/weather/"+e+"/"+t,dataType:"json",type:"GET"};return g.a.ajax(r).done(n).fail(a)},saveUserNameToDB:function(e){var t={url:"/api/user/",dataType:"json",type:"POST",data:{username:e}};return g.a.ajax(t)},loginWithUserName:function(e,t,n){var a={url:"/api/user/login/"+e,dataType:"json",type:"POST",data:{username:e}};return g.a.ajax(a)},saveUserLocation:function(e,t,n,a,r,s){var i={url:"/api/locations/",dataType:"json",type:"POST",data:{userid:e,zipcode:t,lat:n,lng:a}};return g.a.ajax(i).done(r).fail(s)},getUserLocationsById:function(e,t,n){var a={url:"/api/locations/"+e,dataType:"json",type:"GET"};return g.a.ajax(a).done(t).fail(n)}},f=n(0);var x=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={userWeather:[]},a.locationInfo=null,a.debounceOut=!1,a.zipTimeout=null,a.zipChange=function(){a.zipTimeout&&clearTimeout(a.zipTimeout),a.zipTimeout=setTimeout((function(){var e=document.querySelector("input[name='zipcode']").value;a.getLocationInfo(e)}),2e3)},a.getLocationInfo=function(){var e=Object(d.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),n=new RegExp("^[0-9]{5}$"),n.test(t)){e.next=7;break}alert("Please enter a valid zipcode"),e.next=17;break;case 7:return e.prev=7,e.next=10,b.getLocationByZip(t);case 10:this.locationInfo=e.sent,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(7),console.error("No location returned for zipcode.");case 16:this.locationInfo?(this.locationInfo.zipcode=t,this.setState({locationData:this.locationInfo}),console.log(this.locationInfo),document.querySelector("input[name='city']").value=this.locationInfo.city,document.querySelector("input[name='state']").value=this.locationInfo.state):alert("This zip did not return a location.");case 17:case"end":return e.stop()}}),e,this,[[7,13]])})));return function(t){return e.apply(this,arguments)}}(),a.getWeatherForAllLocations=function(){var t=Object(d.a)(h.a.mark((function t(){var n,a,r;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.getUserLocationsById(e.userInfo.id);case 2:return n=t.sent,t.next=5,n.map(function(){var e=Object(d.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.getWeatherMetaData(t.lat,t.lng);case 2:return n=e.sent,a=(a=n[0].shortForecast).charAt(0)+a.substring(1).toLowerCase(),e.abrupt("return",{city:t.city,zipcode:t.zipcode,lat:t.lat,lng:t.lng,current:a,temperature:n[0].temperature});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return a=t.sent,t.next=8,Promise.all(a);case 8:r=t.sent,this.setState({userWeather:r});case 10:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.saveLocation=Object(d.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.props.userInfo){e.next=7;break}return e.next=3,b.saveUserLocation(a.props.userInfo.id,a.locationInfo.zipcode,a.locationInfo.lat,a.locationInfo.lng);case 3:e.sent,a.getWeatherForAllLocations(),e.next=8;break;case 7:prompt("Please try that again.");case 8:case"end":return e.stop()}}),e)}))),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.getWeatherForAllLocations()}},{key:"render",value:function(){var e=this;return Object(f.jsxs)("div",{id:"signed-in",children:[Object(f.jsx)("h2",{children:"Congrats!"}),Object(f.jsxs)("h3",{children:["You are signed with username: ",Object(f.jsx)("span",{id:"signed-in-name",children:this.props.userInfo.username}),"."]}),Object(f.jsxs)("div",{id:"location-info",children:["Zip: ",Object(f.jsx)("input",{type:"text",name:"zipcode",onChange:this.zipChange}),Object(f.jsx)("br",{}),"City: ",Object(f.jsx)("input",{type:"text",name:"city",readOnly:!0}),Object(f.jsx)("br",{}),"State: ",Object(f.jsx)("input",{type:"text",name:"state",readOnly:!0}),Object(f.jsx)("br",{}),Object(f.jsx)("br",{})]}),Object(f.jsxs)("div",{id:"location-buttons",children:[Object(f.jsx)("label",{children:"Is this the location you meant?"}),Object(f.jsx)("button",{className:"btn fourth",onClick:function(){e.saveLocation()},disabled:!this.state.locationData||!this.state.locationData.zipcode,children:"Yes, check weather!"}),Object(f.jsx)("br",{})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("h3",{children:"Your Saved Locations"}),this.state.userWeather.map((function(e,t){return Object(f.jsxs)("p",{children:[e.zipcode,": ",e.current,", with a temperature of ",e.temperature,"."]},t)})),this.state.userWeather&&0!==this.state.userWeather.length?"":Object(f.jsx)("p",{children:" - You currently have no saved locations."})]}),Object(f.jsx)("div",{id:"logout-container",children:Object(f.jsx)("button",{className:"btn fourth",onClick:this.props.onLogout,children:"Logout"})})]})}}]),n}(r.a.Component),v=n(9);function O(){return m.apply(this,arguments)}function m(){return(m=Object(d.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelector("#userinput").value,e.prev=1,e.next=4,b.saveUserNameToDB(t);case 4:n=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log("Error caught",e.t0.responseText);case 10:n?this.setState({signupSuccess:!0,signupFailure:!1}):this.setState({signupFailure:!0,signupSuccess:!1});case 11:case"end":return e.stop()}}),e,this,[[1,7]])})))).apply(this,arguments)}function y(){return S.apply(this,arguments)}function S(){return(S=Object(d.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.querySelector("#userlogin").value,e.prev=1,e.next=4,b.loginWithUserName(n);case 4:t=e.sent,e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:t?(this.setState({loginSuccess:!0,loginFailure:!1}),this.props.onLogin(t)):this.setState({loginSuccess:!1,loginFailure:!0});case 10:case"end":return e.stop()}}),e,this,[[1,7]])})))).apply(this,arguments)}var w=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={signupSuccess:!1,signupFailure:!1,loginSuccess:!1,loginFailure:!1},a.methods={login:y.bind(Object(v.a)(a)),saveUserName:O.bind(Object(v.a)(a))},a}return Object(c.a)(n,[{key:"render",value:function(){return Object(f.jsxs)("div",{id:"login-container",children:[Object(f.jsx)("h1",{children:"Brian's Weather App"}),Object(f.jsxs)("div",{id:"signinlogin",children:[Object(f.jsx)("p",{children:"Sign Up Below:"}),Object(f.jsxs)("div",{id:"style-fields",children:[Object(f.jsxs)("fieldset",{children:[Object(f.jsx)("label",{children:"Username:"}),Object(f.jsx)("input",{type:"text",id:"userinput"}),Object(f.jsx)("button",{onClick:this.methods.saveUserName,children:"Save"}),Object(f.jsx)("br",{}),this.state.signupSuccess?Object(f.jsx)("p",{className:"success",id:"save-user-success",children:"Congrats! You can sign in now!"}):"",this.state.signupFailure?Object(f.jsx)("p",{className:"error",id:"save-user-error",children:"Error. You may already have an account. Try signing in."}):""]}),Object(f.jsxs)("fieldset",{children:[Object(f.jsx)("label",{children:"Login:"}),Object(f.jsx)("input",{type:"text",id:"userlogin"}),Object(f.jsx)("button",{onClick:this.methods.login,children:"Login"}),this.state.loginFailure?Object(f.jsx)("p",{className:"error",id:"save-user-error",children:"Error. Have you signed up?"}):""]})]})]})]})}}]),n}(r.a.Component),I=n.p+"static/media/sun_image.a7748eec.png";var k=function(e){return Object(f.jsx)("div",{className:"App",children:Object(f.jsxs)("header",{className:"App-header",children:[Object(f.jsx)("h1",{children:"Brian's Weather App"}),Object(f.jsx)("img",{src:I,className:"App-logo",alt:"logo"}),Object(f.jsx)("a",{id:"sign-up-link",className:"App-link",target:"_blank",rel:"noopener noreferrer",onClick:function(){e.handler("signup")},children:"Sign Up"})]})})},T=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).state={showPage:"splash",loggedIn:!1,userInfo:null},e.pageChangeHandler=function(t){e.setState({showPage:t})},e.login=function(t){e.setState({loggedIn:!0,userInfo:t}),e.pageChangeHandler("locations")},e.logout=function(){e.setState({userInfo:null}),e.pageChangeHandler("splash")},e}return Object(c.a)(n,[{key:"render",value:function(){var e;return"splash"===this.state.showPage&&(e=Object(f.jsx)(k,{handler:this.pageChangeHandler})),"signup"===this.state.showPage&&(e=Object(f.jsx)(w,{handler:this.pageChangeHandler,onLogin:this.login})),"locations"===this.state.showPage&&(e=Object(f.jsx)(x,{handler:this.pageChangeHandler,userInfo:this.state.userInfo,onLogout:this.logout})),e}}]),n}(r.a.Component),C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,22)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),s(e),i(e)}))};i.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(T,{page:"splash"})}),document.getElementById("root")),C()}},[[21,1,2]]]);
//# sourceMappingURL=main.8ca88c7d.chunk.js.map